#VRML_SIM R2025a utf8
# Two TIAGo robots with empathic Active Inference navigation

EXTERNPROTO "https://raw.githubusercontent.com/cyberbotics/webots/R2025a/projects/objects/backgrounds/protos/TexturedBackground.proto"
EXTERNPROTO "https://raw.githubusercontent.com/cyberbotics/webots/R2025a/projects/objects/backgrounds/protos/TexturedBackgroundLight.proto"
EXTERNPROTO "https://raw.githubusercontent.com/cyberbotics/webots/R2025a/projects/objects/floors/protos/RectangleArena.proto"
EXTERNPROTO "https://raw.githubusercontent.com/cyberbotics/webots/R2025a/projects/robots/pal_robotics/tiago/protos/Tiago.proto"
EXTERNPROTO "../protos/Target.proto"
EXTERNPROTO "../protos/HazardObstacle.proto"

WorldInfo {
  title "TIAGo Empathic Navigation Test"
  basicTimeStep 16
}

Viewpoint {
  orientation -0.5773 0.5773 0.5773 2.0944
  position 0 0 6
}

TexturedBackground {
  texture "empty_office"
}

TexturedBackgroundLight {
  texture "empty_office"
}

# Floor - larger arena for TIAGo robots
RectangleArena {
  floorSize 5 2
}

# Hazard/Lava - top row (moved to Y=0.75 for wider corridor)
HazardObstacle {
  translation -0.5 0.75 0.075
  name "hazard_top_1"
  size 0.6 0.5 0.15
}
HazardObstacle {
  translation 0.5 0.75 0.075
  name "hazard_top_2"
  size 0.6 0.5 0.15
}

# Hazard/Lava - bottom row (moved to Y=-0.75 for wider corridor)
HazardObstacle {
  translation -1.5 -0.75 0.075
  name "hazard_bottom_0"
  size 0.6 0.5 0.15
}
HazardObstacle {
  translation -0.5 -0.75 0.075
  name "hazard_bottom_1"
  size 0.6 0.5 0.15
}
HazardObstacle {
  translation 0.5 -0.75 0.075
  name "hazard_bottom_2"
  size 0.6 0.5 0.15
}
HazardObstacle {
  translation 1.5 -0.75 0.075
  name "hazard_bottom_3"
  size 0.6 0.5 0.15
}

# Goal markers
Target {
  translation 1.8 0.0 0.02
  name "Goal_TIAGo_1"
  color 0.2 0.5 1
  radius 0.15
}

Target {
  translation -1.8 0.0 0.02
  name "Goal_TIAGo_2"
  color 1 0.4 0.7
  radius 0.15
}

# Empathy indicators - floating markers above starting positions
# RED = Selfish (alpha=0.0), GREEN = Empathic (alpha=6.0)
DEF MARKER_SELFISH Solid {
  translation -1.8 0.0 1.8
  children [
    Shape {
      appearance PBRAppearance {
        baseColor 1 0.2 0.2
        emissiveColor 0.5 0 0
        roughness 0.3
        metalness 0
      }
      geometry Sphere {
        radius 0.12
      }
    }
  ]
  name "marker_selfish"
}

DEF MARKER_EMPATHIC Solid {
  translation 1.8 0.0 1.8
  children [
    Shape {
      appearance PBRAppearance {
        baseColor 0.2 1 0.4
        emissiveColor 0 0.5 0
        roughness 0.3
        metalness 0
      }
      geometry Sphere {
        radius 0.12
      }
    }
  ]
  name "marker_empathic"
}

# TIAGo 1 - starts on left, goal on right
# customData: goal_x, goal_y, alpha, agent_id
# alpha=0.0 (purely selfish - ignores other robot completely)
Tiago {
  translation -1.8 0.0 0.095
  rotation 0 0 1 0
  name "TIAGo_1"
  controller "tiago_empathic"
  supervisor TRUE
  customData "1.8,0.0,0.0,0"
}

# TIAGo 2 - starts on right, goal on left
# alpha=6.0 (highly empathic - will yield completely to let other pass)
Tiago {
  translation 1.8 0.0 0.095
  rotation 0 0 1 3.14159
  name "TIAGo_2"
  controller "tiago_empathic"
  supervisor TRUE
  customData "-1.8,0.0,6.0,1"
}
